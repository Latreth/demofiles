<!DOCTYPE html>

<title>Fibonacci</title>

<style type="text/css">
 body { font-family: Consolas, monospace; }
 h1 { size: 120%; color: #80c0ff; font-family: Calibri, sans-serif;}
 b { color: orange; }
 table.hsl {
  width: auto;
  margin-left: auto;
  margin-right: auto;
  background-color: #A0A0A0;
  border-width: 2px 10px 10px 2px;
  border-style: solid;
  border-color: #A0A0A0;
  border-collapse: collapse;
  line-height: 1.33em;
 }
 table.hsl td {
  border: 1px solid #A0A0A0;
  padding: 0.1em 0.2em;
  color: black;
  font-family: Consolas, monospace;
  width: 3em;
  background-color: #C0C0C0;
 }
 table.hsl tr:first-child td,
 table.hsl tr:nth-child(2) td {
  text-align: center;
  background-color: transparent;
 }
 table.hsl td:first-child {
  text-align: right;
  background-color: transparent;
 }

 .ignore td {
   background-color: transparent;
   padding-top: 1em;
 }
 #slider {
   margin: 0;
   inline-size: 100%;
 }
</style>

<script type="text/javascript">
 var n, fibo = [0, 1];

 // ici, remplir le tableau fibo avec les 25 premières valeurs
 for (n = 3; n < 25; n++) {
  fibo[n-1] = fibo[n-2] + fibo[n-3];
 }

 // ici, afficher le contenu du tableau à l'aide de console.log
 console.log(fibo.toString());

</script>

<body>

 <h1>1.2 - document.write</h1>
 <div>
  <script type="text/javascript">
   var str = ''; // str sera global, car je ne suis pas dans une fonction

   // ici, afficher le contenu du tableau à l'aide de document.write
   for (n = 0; n < 24; n++) {
    str += '<b>' + fibo[n] + '</b>';
    if ( n < 23 ) str += ', ';
   }
   document.write(str);
  </script>
 </div>

 <h1>1.3 - innerHTML</h1>
 <div id="dropzone"></div>
 <script type="text/javascript">
  // ici afficher le contenu du tableau dans le div nommé dropzone
  // à l'aide de la propriété innerHTML

  window.document.getElementById('dropzone').innerHTML = str;
  // ou (HTML5)
  window.dropzone.innerHTML = str;
  // voire même
  dropzone.innerHTML = str;

 </script>

 <h1>1.4 - element.appendChild</h1>
 <div id="container"></div>
 <script type="text/javascript">
  // ici afficher le contenu du tableau dans le div nommé container
  // à l'aide des fonctions du DOM
  var frag = document.createDocumentFragment();
  var value, b, comma;
  for (n = 0; n < 24; n++) {
    value = document.createTextNode(fibo[n]);
    b = document.createElement('b');
    b.appendChild(value);
    frag.appendChild(b);
    if ( n < 23 ) {
      comma = document.createTextNode(', ');
      frag.appendChild(comma);
    }
  }

  // en plus compact
  frag.appendChild(document.createElement('br'));
  for (n = 0; n < 24; n++) {
    b = document.createElement('b')
    b.appendChild( document.createTextNode(fibo[n]));
    frag.appendChild(b);
    if ( n < 23 ) {
      frag.appendChild( document.createTextNode(', '));
    }
  }

  container.appendChild(frag);
 </script>

 <h1>2.1 - tableau HSL</h1>
 <table id="hsl1" class="hsl">
  <tr><td> </td><td colspan=5>saturation</td></tr>
  <tr><td>lum</td><td>100%</td><td>75%</td><td>50%</td><td>25%</td><td>0%</td></tr>
  <tr><td>100%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>87.50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>75%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>62.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>37.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>25%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>12.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>0%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
 </table>
 <script type="text/javascript">
   // ici initialiser le couleur des cellules du tableau
   // à l'aide de la propriété CSS background-color
   // afin d'obtenir le résultat approprié...
   function paintTable(table,hue) {
     var rows = table.getElementsByTagName('tr');
     var row, cells, cell, lum, sat, hsl;
     var saturations = rows[1].getElementsByTagName('td');
     for ( r = 2; r < rows.length; r++ ) {
       row = rows[r];
       if ( row.className == "ignore" ) continue;
       cells = row.getElementsByTagName('td');
       lum = cells[0].textContent;
       for ( c = 1; c < cells.length; c++ ) {
         sat = saturations[c].textContent;
         hsl = 'hsl('+hue+','+sat+','+lum+')';
         cells[c].style.backgroundColor = hsl;
       }
     }
   }
   paintTable(hsl1,0);
 </script>

 <h1>2.2 - tableau HSL variable</h1>
 <table id="hsl2" class="hsl">
  <tr><td> </td><td colspan=5>saturation</td></tr>
  <tr><td>lum</td><td>100%</td><td>75%</td><td>50%</td><td>25%</td><td>0%</td></tr>
  <tr><td>100%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>87.50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>75%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>62.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>37.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>25%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>12.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>0%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
 </table>
 <script type="text/javascript">
  // ici, prévoir une fonction modifiant les couleurs du tableau 2
  // en fonction du déplacement de la souris
  document.body.addEventListener('mousemove', function(e) {
    // avec une petite approximation dûe aux marges...
    var hue = e.clientX * 360 / e.currentTarget.clientWidth;
    paintTable(hsl2,hue);
  });
 </script>

 <h1>2.3 - tableau HSL variable avec curseur</h1>
 <table id="hsl3" class="hsl">
  <tr><td> </td><td colspan=5>saturation</td></tr>
  <tr><td>lum</td><td>100%</td><td>75%</td><td>50%</td><td>25%</td><td>0%</td></tr>
  <tr><td>100%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>87.50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>75%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>62.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>50%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>37.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>25%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>12.5%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
  <tr><td>0%</td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>

  <!-- curseur  -->
  <tr class="ignore">
   <td>hue</td>
   <td style="background-color: transparent"><span>0</span>°</td>
   <td colspan="4" style="background-color: transparent; padding-top: 1em;">
    <input type="range" min="0" max="360" value="0" id="slider" style="margin: 0; inline-size: 100%"/>
   </td>
  </tr>

 </table>

 <!-- gestion du curseur -->
 <script type="text/javascript">
  slider.addEventListener('input', function(e) {
    var hue = e.currentTarget.value;
    e.currentTarget            // input
     .parentNode               // td colspan=4
     .previousSibling          // text node
     .previousSibling          // td
     .getElementsByTagName('span')[0].textContent = hue;
    paintTable(hsl3,hue);
  });
  paintTable(hsl3,0);
 </script>

</body>
